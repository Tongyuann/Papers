# An LLM-based approach for enabling seamless Human-Robot collaboration in assembly
#### 在装配中实现基于LLM的人机合作的方法
## 摘要
在智能制造中，人与机器人之间协作的复杂性仍然是一个重大挑战。介绍了一种基于LLM的制造执行系统，增强了智能制造中人-机器人协作(HRC)的能力。通过利用大型语言模型(LLM)，该系统为操作员提供了自然语言界面，与数字双胞胎集成以获取实时数据，并为机器人采用基于行为的控制。这种集成促进了直观的交互和快速的系统编程，解决了HRC中的通信复杂性。该方法的有效性通过两个HRC装配案例研究得到验证，展示了协作和效率的显着改善。
## 简介
文提出了一种新颖的方法，用于在装配任务中高效、直观地协调和交互人类和机器人资源。利用LLM广泛的语义知识，该系统擅长识别人与机器人之间协作组装的实际任务。这种方法使HRC装配系统的编程变得容易，并增强了非专业用户的交互，详细介绍了一种实现LLM应用程序的方法，以提取制造的相关信息，管理任务执行，并实现与人类工人和工程师的自然语言交互。该解决方案弥合了LLM的叙述能力与物理协作制造环境的实际需求之间的差距，并专注于LLM创建的“制造推理”
## 基于LLM的HRC执行系统
该系统具有以下几个关键特征:
1. 系统知识:获得制造业专有的知识基础和数据源
2. 在线信息:与系统的数字孪生体(DT)集成，允许访问动态更新的数据。当需要获取和使用系统的运行时状态时，此功能是强制性的
3. 可扩展性:模块化架构，允许根据应用需求轻松重新配置。AI组件的训练是独立执行的，可以轻松添加新功能，而不会影响现有组件的性能
4. 可解释性:一个透明的过程，可以由人类监控，允许在观察和决策中进行一定程度的控制
     
***系统框架***：基于LLM的HRC方法基于一组可扩展的模块，每个模块在HRC环境中提供不同的功能
1. 代理是神经模块，包括LLM、微调LMs或任何其他支持AI的组件，其目标是**根据输入对动作进行分类**
2. 模块是实现代理调用的操作函数的符号工具。这些模块用于连接外部api，如数据库、机器人控制器等
![](https://pic.imgdb.cn/item/66bafae6d9c307b7e98891bf.png)
#### 代理
代理是负责系统观察和交互的完整神经模块。该系统包含两个专门的代理:**交互代理**和**制造代理**。这两种都是利用思维链方法进行微调的，这有助于减少幻觉问题。通过定义一系列推理步骤，该方法缩小了响应空间，从而专注于有针对性的相关输出  
**交互代理**(Interaction Agent)主要负责处理与用户的对话。它采用“计划-执行”策略，并配备会话记忆缓冲，增强了管理和维持用户交互的能力  
**制造代理**处理与系统中部署的HRC组件相关的问题，该代理负责生成全面的生产计划或修改正在运行的装配计划中的现有任务。HRC-GPT拥有生产系统的内在知识，通过矢量增强和提示技术集成制造数据增强了这种能力，拥有“制造推理”的HRC-GPT擅长于创建精确的装配时间表，并与管理资源控制的各个模块进行交互
#### 模块
本文提出的方法包括两个主要模块，作为与物理世界的桥梁:**人类交互模块**和**机器人行为规划模块**  
**人类交互模块**旨在促进人类操作员与系统之间的自然通信。它配备了自然语言处理(NLP)功能，包括语音转文本和文本转语音功能，该模块在基于llm的系统中扮演着双重角色:*首先，作为输入接口，使人类操作员能够通过自然语言与系统进行无缝交互;其次，作为输出接口，将系统生成的信息有效地传达给人类用户*
**机器人行为模块**在这个过程中起着至关重要的作用。它的任务是接收制造代理生成的行为树（bt），并随后将它们转发给执行。这种方法使LLM系统能够产生精确的输出，这些输出不仅在理论上是合理的，而且在物理世界中也是实际可执行的
#### 制造数据和培训
将特定的HRC知识集成到我们的装配系统的LLM培训采用，了一种综合的方法，利用不同数据源的矢量化表示。输入的制造数据被组织在几个结构化文件中。这些数据包含几个关键组成部分:***工艺规划细节、综合资源信息、几何布局数据以及为机器人执行而设计的原始行为集合***  
资源数据提供了工具和设备的广泛清单，概述了它们的**约束和操作限制**。这些数据被认为是促进改进资源分配的关键，有助于规划任务调度
![](https://pic.imgdb.cn/item/66bafeead9c307b7e98c6ba1.png)  
**为了有效地将这些数据合并到LLM中，需要使用嵌入模型将其转换为矢量化格式。对每个数据段进行处理，生成一个语义向量。这种矢量化是使用text-embedding-ada-002模型执行的，该模型为每个数据段生成一个1536维的输出矩阵。该矩阵用作创建HRC-GPT的基础。自定义训练模型采用余弦相似度度量来检索相关数据段，这些数据段被概念化为向量空间中的相邻向量。然后系统生成一个提示，将这个检索到的数据与内部内存摘要结合起来。这种方法与CoT提示工程相结合，可以为HRC系统生成与上下文相关且精确的响应**  
在我们的案例研究中，基于LLM的执行系统的初始应用包括将生产工程师的自然语言输入转换为详细的生产计划。此过程由特定的关键绩效指标(kpi)驱动。该系统的主要目标是生成一个**时间表**，该时间表不仅符合查询中嵌入的语义规则，而且在物理制造环境中也是可执行的。该系统采用了“思维链”的方法，使其能够全面掌握输入查询的潜在含义。
## 结论
本研究建立了一个健壮的框架，使用基于llm的系统作为制造环境中的协调器。本文的主要目标是阐明“制造推理”的概念及其在利用llm能力方面的必要性。提出的解决方案展示了LLM系统在实际HRC装配站中的端到端(从编程到执行)应用。使用真实工业数据对该方法进行的部署和评估突出了该系统在实际场景中的巨大潜力。